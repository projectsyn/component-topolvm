apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  annotations:
    cert-manager.io/inject-ca-from: syn-topolvm/topolvm-mutatingwebhook
  labels:
    app.kubernetes.io/instance: topolvm
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: topolvm
    app.kubernetes.io/version: 0.18.2
    helm.sh/chart: topolvm-11.2.0
  name: topolvm-hook
webhooks:
  - admissionReviewVersions:
      - v1
      - v1beta1
    clientConfig:
      service:
        name: topolvm-controller
        namespace: syn-topolvm
        path: /pvc/mutate
    failurePolicy: Fail
    matchPolicy: Equivalent
    name: pvc-hook.topolvm.cybozu.com
    namespaceSelector:
      matchExpressions:
        - key: topolvm.cybozu.com/webhook
          operator: NotIn
          values:
            - ignore
    rules:
      - apiGroups:
          - ''
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - persistentvolumeclaims
    sideEffects: None
